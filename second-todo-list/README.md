# second-todo-list

このチュートリアルでは、アプリケーションをデータベースに接続する作業を行います。タスクをデータベースに登録したり、あるいはデータベースに登録されているタスクの一覧を JSON で返すといったエンドポイントを作ります。

## 事前準備

データベースには SQLite を使用します。なので、手元の環境に SQLite がない方は、まずそちらをご用意ください。

下記のサイトよりダウンロードするか、あるいはお手元の OS のパッケージマネージャを使用してインストールしてください。

- https://www.sqlite.org/download.html

## データベースに接続するクレートを追加する

今回は下記のクレートを使用して、SQLite に接続してみます。

Cargo.toml に下記依存を追加してください。

```toml
r2d2 = "0.8.9"
r2d2_sqlite = "0.18.0"
rusqlite = "0.25.0"
```

- `r2d2`: コネクションプールを管理する際に使用するクレートです。
- `r2d2_sqlite`: r2d2 と rusqlite を統合して使用できるようにするクレートです。
- `rusqlite`: SQLite 向けにクエリの実行などを行えるようにするクレートです。

## 新しいデータ構造を用意する

今回作るのは JSON をボディにもつ HTTP リクエストを POST で送ると、JSON の内容をパースしてデータベースにタスク内容を保存するエンドポイントを作成します。

前回のチュートリアルで作成した `Todo` という構造体がそのまま使えるのではないか？と思うかもしれませんが、下記の理由から `Todo` 構造体はそのままでは使用できません。

- JSON リクエストの内容的に、`Todo` 構造体をそのまま使うと無駄が多い。

なので、HTTP リクエストに関しては特別に構造体を用意します。

今回は下記のような JSON リクエストを送ろうとしています。

```json
{
  "description": "Rustハンズオン準備"
}
```

`Todo` 構造体で用意したような `done` や `datetime` などはリクエストに含まれません。不要なフィールドが多いので、便宜的に別の構造体を作って対応することにします。
